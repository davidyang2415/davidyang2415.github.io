---
layout: post
title: Qt学习：进程与线程
categories:
- Qt
tags:
- Qt
- Library
---

## 进程
> 主要是两个方面：进程，进程间通信

- 进程，使用QProcess表示一个进程
	- 进程状态发生变化时会触发相应的信号
- 进程间通信
	- 方式：共享内存, TCP/IP, D-Bus, QCOP(嵌入式)
	- 进程间通信的应用：
		- 程序的单开与多开控制
		- 程序族中的程序通信，如QQ、QQ音乐、QQ游戏等

---
## 线程
> Qt的线程看起来简单，但是坑比较多，需要多注意。

### 线程相关类

- QThread
	- 具有优先级，可运行事件循环
- QRunnable
- QtConcurrent
	- 高级接口，设计QFuture对象

### 线程使用
> 线程一般用于耗时计算

- 复杂的应用在熟练掌握前谨慎使用

---
## 线程和QObject

### 事件循环与线程
- 主循环，GUI循环，在main函数中执行
- QThread也可以开启自己的事件循环
	- 事件循环处理的是QThread创建的对象的事件
- 可以在主循环中创建局部事件循环
	- 比如等待异步处理(如网络应答)完成

### QObject对象的附属线程
- QObject对象会有一个附属线程属性
	- 对象创建时的线程
		- 在QApplication前创建的对象没有附属线程
		- QThread构造函数中创建的对象是创建线程而不是定义的线程
	- 对象上的事件处理是由附属线程的事件循环派发

---
## 线程小结
> 使用线程的情况

- 不得不使用同步API时
- 扩展到多核应用时
- 不想被别人阻塞时

> 不应该使用线程的情况

- 定时器
- 网络/状态机
- 将任务分割成若干部分